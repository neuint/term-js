import e,{useRef as r,useCallback as n,useEffect as t,useMemo as o,Children as a}from"react";import s from"@neuint/modals-plugin";import{createPortal as c}from"react-dom";var u,i=new Uint8Array(16);function l(){if(!u&&!(u="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return u(i)}var d=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function m(e){return"string"==typeof e&&d.test(e)}for(var p,g,f=[],v=0;v<256;++v)f.push((v+256).toString(16).substr(1));var y=0,C=0;function h(e,r,n){var t=r&&n||0,o=r||new Array(16),a=(e=e||{}).node||p,s=void 0!==e.clockseq?e.clockseq:g;if(null==a||null==s){var c=e.random||(e.rng||l)();null==a&&(a=p=[1|c[0],c[1],c[2],c[3],c[4],c[5]]),null==s&&(s=g=16383&(c[6]<<8|c[7]))}var u=void 0!==e.msecs?e.msecs:Date.now(),i=void 0!==e.nsecs?e.nsecs:C+1,d=u-y+(i-C)/1e4;if(d<0&&void 0===e.clockseq&&(s=s+1&16383),(d<0||u>y)&&void 0===e.nsecs&&(i=0),i>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");y=u,C=i,g=s;var v=(1e4*(268435455&(u+=122192928e5))+i)%4294967296;o[t++]=v>>>24&255,o[t++]=v>>>16&255,o[t++]=v>>>8&255,o[t++]=255&v;var h=u/4294967296*1e4&268435455;o[t++]=h>>>8&255,o[t++]=255&h,o[t++]=h>>>24&15|16,o[t++]=h>>>16&255,o[t++]=s>>>8|128,o[t++]=255&s;for(var w=0;w<6;++w)o[t+w]=a[w];return r||function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(f[e[r+0]]+f[e[r+1]]+f[e[r+2]]+f[e[r+3]]+"-"+f[e[r+4]]+f[e[r+5]]+"-"+f[e[r+6]]+f[e[r+7]]+"-"+f[e[r+8]]+f[e[r+9]]+"-"+f[e[r+10]]+f[e[r+11]]+f[e[r+12]]+f[e[r+13]]+f[e[r+14]]+f[e[r+15]]).toLowerCase();if(!m(n))throw TypeError("Stringified UUID is invalid");return n}(o)}const w=e=>{const{overlayHide:o,closeButton:a,escHide:s,title:u,className:i,actions:l,children:d,plugin:m,onClose:p}=e,g=r({overlayHide:o,closeButton:a,escHide:s,title:u,className:i,actions:l,onClose:p}),f=r(),v=r(`modal_${h().replace(/-/g,"")}`),y=r(document.createElement("div")),C=n((()=>{g.current.onClose&&g.current.onClose()}),[]);return t((()=>()=>{f.current&&f.current(),C()}),[C]),t((()=>{g.current={overlayHide:o,closeButton:a,escHide:s,title:u,className:i,actions:l,onClose:p}}),[o,a,s,u,i,l,p]),t((()=>{f.current=m.show(Object.assign(Object.assign({},g.current),{onClose:C,content:y.current,className:g.current.className?`${v.current} ${g.current.className}`:v.current}))}),[m,C]),d?c(d,y.current):null},b=({term:n,children:c})=>{const u=r(new s(n.pluginManager));return o((()=>{const{current:e}=u;n.pluginManager.register(e)}),[n.pluginManager]),t((()=>()=>{n.pluginManager.unregister(u.current)}),[n.pluginManager]),c?a.map(c,(r=>e.cloneElement(r,{plugin:u.current}))):null};export{w as ModalComponent,b as default};
