import{uniq as t}from"lodash-es";import{Plugin as e}from"@neuint/term-js";import s from"@neuint/autocomplete-plugin";const o=navigator.platform.toUpperCase().indexOf("MAC")>=0;class i extends e{constructor(t,e){super(t),this.name="history-search-plugin",this.history=[],this.actionShortcut={code:89,meta:o,ctrl:!o},e&&(this.actionShortcut=e)}setTermInfo(t,e){super.setTermInfo(t,e),this.setAutocomplete(),this.setHistoryList()}updateTermInfo(t){super.updateTermInfo(t),this.setHistoryList()}clear(){const{autocomplete:t}=this;t&&t.clear()}destroy(){this.clear(),super.destroy()}setAutocomplete(){const{termInfo:t}=this;if(!t)return;const e=this.pluginManager.getPlugin(s);e?this.autocomplete=e:(this.autocomplete=new s(this.pluginManager),this.pluginManager.register(this.autocomplete))}setHistoryList(){const{termInfo:t,removeList:e,autocomplete:s}=this;t&&s&&this.checkUpdateHistoryList()&&(e&&e(),this.removeList=s.addList(this.history,this.actionShortcut,'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke="none">\n  <path stroke="none" d="M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z"/>\n</svg>\n'))}checkUpdateHistoryList(){var e;const{history:s}=this,o=t((null===(e=this.termInfo)||void 0===e?void 0:e.history)||[]);return!(!o.length||s.length===o.length&&!o.some(((t,e)=>t!==s[e])))&&(this.history=o,!0)}}export{i as default};
